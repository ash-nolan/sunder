import "std/core.sunder";
import "std/fs.sunder";

const path: []byte = "data.tmp";

func main() void {
    var result: std::result[[std::file, []byte]] = std::file::open(path, std::file::OPEN_READ | std::file::OPEN_WRITE);
    var file: std::file = result.value();
    defer { file.fini(); }

    var reader: std::reader = std::reader::init[[std::file]](&file);
    var writer: std::writer = std::writer::init[[std::file]](&file);

    std::print_line(writer, "SOME TEXT");
    var result = file.seek(0, std::file::SEEK_START);
    std::assert(result.is_value());

    var buf: [512]byte = (:[512]byte)[0...];
    var result: std::result[[usize, []byte]] = reader.read(buf[0:countof(buf)]);
    std::print_line(std::out(), buf[0:result.value()]);
}
################################################################################
# SOME TEXT
