import "std/core.sunder";
import "std/fs.sunder";
import "sys/sys.sunder";

const path: []byte = "data.tmp";

func main() void {
    var open_result: std::result[[:std::fs::file, :std::fs::error]] =
        std::fs::file::open(path, std::fs::OPEN_READ | std::fs::OPEN_WRITE);
    var file: std::fs::file = open_result.value();
    var reader: std::reader = std::reader::init[[:std::fs::file]](&file);
    var writer: std::writer = std::writer::init[[:std::fs::file]](&file);
    std::print_line(writer, "SOME TEXT");
    file.seek(0, std::fs::SEEK_START);
    var buf: [512]byte = (:[512]byte)[0...];
    var read_result: std::result[[:usize, :[]byte]] =
        reader.read(buf[0:countof(buf)]);
    std::print_line(std::out(), buf[0:read_result.value()]);
    file.close();
}
################################################################################
# SOME TEXT
