#!/bin/sh

usage() {
    cat <<EOF
Usage: $(basename $0) FILE ARGS...

Options:
  -h, --help        Print this help message and exit.
EOF
}

while test "$#" -eq 0; do
    usage
    exit 0
done

case "$1" in
    -h|--help)
        usage
        exit 0
        ;;
    *)
        break
        ;;
esac
FILE="${1}"

if [ -z "${SUNDER_HOME}" ]; then
    SUNDER_HOME=$(pwd)
fi

if ! "${SUNDER_HOME}/bin/sunder-compile" "${FILE}"; then
    exit 1
fi

shift
./a.out $@
rm a.out
exit $?
