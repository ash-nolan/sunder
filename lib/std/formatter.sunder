namespace std;
import "std/writer.sunder";

struct formatter_vtable {
    var format: func(*any, *std::writer, []byte) void;
}

struct formatter {
    var vtable: *std::formatter_vtable;
    var self: *any;

    func init[[:T]](self: *T) std::formatter {
        const vtable: std::formatter_vtable = (:std::formatter_vtable){
            .format = T::format
        };
        return (:std::formatter){
            .vtable = &vtable,
            .self = self
        };
    }
}
